<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Generator für Aktivität Anwesenheit</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="script.js"></script>
    <script src="xlsx.full.min.js"></script>
  </head>

  <body>
    <main>
      <h1>Termine für Moodle-Aktivität <em>Anwesenheit</em> erzeugen</h1>

      <section class="step-1">
        <h2>Schritt 1: Herausfinden der Lehrveranstaltungs-ID</h2>
        <p>Die Lehrveranstaltungs-ID kann über CIS bestimmt werden.</p>
        <ol>
          <li>
            Öffnen Sie die Lehrveranstaltungsübersicht durch Klick auf den
            Button.
          </li>
          <li>Wählen Sie die gewünschte Lehrveranstaltung aus.</li>
          <li>
            Wenn der Mauszeiger über der gewünschten Lehrveranstaltung steht,
            drücken Sie die rechte Maustaste und wählen Sie
            <em>Link-Adresse kopieren</em> oder
            <em>Adresse des Links kopieren</em>.
          </li>
          <li>Fügen Sie die Adresse im untenstehenden Textfeld ein.</li>
        </ol>

        <form>
          <label for="url">Adresse</label>
          <input type="text" name="url" id="url" />
          <label>Alternativ</label>
          <div class="group">
            <label for="stsem">Semester</label>
            <select name="stsem" id="stsem">
              <option>WS2024</option>
              <option>SS2025</option>
              <option>WS2025</option>
            </select>
            <label for="lvid">Lehrveranstaltungs-ID</label>
            <input type="text" name="lvid" maxlength="6" pattern="[0-9]*" id="lvid"/>  
            <button>Absenden</button>
          </div>
          <p class="error"></p>
          <button class="js-step2" type="button">Ich habe bereits die Lehrveranstaltungstermine als XLS-Datei</button>
        </form>
        <iframe src="load-cis.html"></iframe>
      </section>

      <section class="step-2">
        <h2>Schritt 2: Laden der Lehrveranstaltungs-Termine</h2>
        <ol>
          <li>
            Laden Sie die Lehrveranstaltungstermine über diesen
            <a href="">Link</a> herunter.
          </li>
          <li>Laden Sie die Termine über untenstehendes Feld hoch.</li>
        </ol>

        <form>
          <label for="xls">Datei-Upload</label>
          <input type="file" name="xls" id="xls" />
          <p class="error"></p>
        </form>

        <div class="table"></div>
      </section>

      <section class="step-3">
        <h2>Schritt 3: Bereitstellen der Tabelle für den Import</h2>
        <ol>
          <li>
            Prüfen Sie die Korrektheit der Termine in der untenstehenden
            Tabelle.
          </li>
          <li>
            Laden Sie die Tabelle mit den Terminen für den Import über
            untenstehenen Button herunter.
          </li>
          <li>
            Stellen Sie sicher, dass in den Einstellungen der Aktivität
            <em>Anwesenheit</em> der Gruppenmodus auf
            <em>Getrennte Gruppen</em> eingestellt ist.
          </li>
          <li>
            Importieren Sie diese Tabelle in die Aktivität
            <em>Anwesenheit</em> über die dortige Importfunktion mit dem
            Strichpunkt (;) als CSV-Trennzeichen.
          </li>
          <li>
            Ignorieren Sie Fehlermeldungen über nicht vorhandene Gruppen, falls
            diese angezeigt werden.
          </li>
        </ol>
        <p>
          Nun können Sie die Anwesenheit durch Herzeigen des QR-Codes während
          der Lehrveranstaltung automatisiert erfassen.
        </p>

        <button class="js-download">Download der Tabelle</button>
        <button class="js-step1">Zurück zum ersten Schritt</button>

        <div class="table"></div>
      </section>
    </main>
  </body>
</html>
